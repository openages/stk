var M=(e,r)=>{for(let t in r)if(r.hasOwnProperty(t)&&t!=="constructor"&&r[t]!==void 0)e[t]=r[t]},u=(e,r,t,n)=>{if(r)M(e,r);if(t)M(e,t);if(n)M(e,n);return e},V=(e,r,t,n="height")=>{return t==="center"?(e[n]+r[n])/2:e.height};var F=18,se=F*2,Y=F,ce={getId(e){return e.id||e.name},getPreH(e){return e.preH||0},getPreV(e){return e.preV||0},getHGap(e){return e.hgap||Y},getVGap(e){return e.vgap||Y},getChildren(e){return e.children},getHeight(e){return e.height||se},getWidth(e){let r=e.label||" ";return e.width||r.split("").length*F}};function I(e,r){let t=this;if(t.vgap=t.hgap=0,e instanceof I)return e;t.data=e;let n=r.getHGap(e),h=r.getVGap(e);if(t.id=r.getId(e),t.preH=r.getPreH(e),t.preV=r.getPreV(e),t.width=r.getWidth(e),t.height=r.getHeight(e),t.width+=t.preH,t.height+=t.preV,t.x=t.y=0,t.depth=0,!t.children)t.children=[];return t.addGap(n,h),t}var ae={isRoot(){return this.depth===0},isLeaf(){return this.children.length===0},addGap(e,r){let t=this;t.hgap+=e,t.vgap+=r,t.width+=2*e,t.height+=2*r},eachNode(e){let t=[this],n=null;while(n=t.shift())e(n),t=n.children.concat(t)},DFTraverse(e){this.eachNode(e)},BFTraverse(e){let t=[this],n=null;while(n=t.shift())e(n),t=t.concat(n.children)},getBoundingBox(){let e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode((r)=>{e.left=Math.min(e.left,r.x),e.top=Math.min(e.top,r.y),e.width=Math.max(e.width,r.x+r.width),e.height=Math.max(e.height,r.y+r.height)}),e},translate(e=0,r=0){this.eachNode((t)=>{t.x+=e,t.y+=r,t.x+=t.preH,t.y+=t.preV})},right2left(){let e=this,r=e.getBoundingBox();e.eachNode((t)=>{t.x=t.x-(t.x-r.left)*2-t.width}),e.translate(r.width,0)},bottom2top(){let e=this,r=e.getBoundingBox();e.eachNode((t)=>{t.y=t.y-(t.y-r.top)*2-t.height}),e.translate(0,r.height)}};u(I.prototype,ae);var S=(e,r={},t)=>{r=u(ce,r);let n=new I(e,r),h=[n],o=null;if(!t&&!e.collapsed){while(o=h.shift())if(!o.data.collapsed){let f=r.getChildren(o.data),s=f?f.length:0;if(o.children=new Array(s),f&&s)for(let l=0;l<s;l++){let m=new I(f[l],r);o.children[l]=m,h.push(m),m.parent=o,m.depth=o.depth+1}}}return n};class g{rootNode=null;options={};constructor(e,r={}){this.options=r,this.rootNode=S(e,r)}execute(){throw new Error("please override this method")}}var B=(e,r)=>{let t=S(e.data,r,!0),n=S(e.data,r,!0),h=e.children.length,o=Math.round(h/2),f=r.getSide||((s,l)=>l<o?"right":"left");for(let s=0;s<h;s++){let l=e.children[s];if(f(l,s)==="right")n.children.push(l);else t.children.push(l)}return t.eachNode((s)=>{if(!s.isRoot())s.side="left"}),n.eachNode((s)=>{if(!s.isRoot())s.side="right"}),{left:t,right:n}};var T=["LR","RL","TB","BT","H","V"],fe=["LR","RL","H"],pe=T[0],de=(e)=>fe.indexOf(e)>-1,w=(e,r,t)=>{let n=r.direction||pe;if(r.isHorizontal=de(n),n&&T.indexOf(n)===-1)throw new TypeError(`Invalid direction: ${n}`);if(n===T[0])t(e,r);else if(n===T[1])t(e,r),e.right2left();else if(n===T[2])t(e,r);else if(n===T[3])t(e,r),e.bottom2top();else if(n===T[4]||n===T[5]){let{left:o,right:f}=B(e,r);t(o,r),t(f,r),r.isHorizontal?o.right2left():o.bottom2top(),f.translate(o.x-f.x,o.y-f.y),e.x=o.x,e.y=f.y;let s=e.getBoundingBox();if(r.isHorizontal){if(s.top<0)e.translate(0,-s.top)}else if(s.left<0)e.translate(-s.left,0)}let h=r.fixedRoot;if(h===void 0)h=!0;if(h)e.translate(-(e.x+e.width/2+e.hgap),-(e.y+e.height/2+e.vgap));return e};function D(e,r,t,n=[]){let h=this;h.x=0,h.y=t||0,h.w=e||0,h.h=r||0,h.c=n||[],h.cs=n.length,h.prelim=0,h.mod=0,h.shift=0,h.change=0,h.tl=null,h.tr=null,h.el=null,h.er=null,h.msel=0,h.mser=0}D.fromNode=(e,r)=>{if(!e)return null;let t=[];if(e.children.forEach((n)=>{t.push(D.fromNode(n,r))}),r)return new D(e.height,e.width,e.x,t);return new D(e.width,e.height,e.y,t)};function $(e,r,t){if(t)e.y+=r;else e.x+=r;e.children.forEach((n)=>{$(n,r,t)})}function Z(e,r){let t=r?e.y:e.x;return e.children.forEach((n)=>{t=Math.min(Z(n,r),t)}),t}function me(e,r){let t=Z(e,r);$(e,-t,r)}function q(e,r,t){if(t)r.y=e.x;else r.x=e.x;e.c.forEach((n,h)=>{q(n,r.children[h],t)})}function J(e,r,t=0){if(r)e.x=t,t+=e.width;else e.y=t,t+=e.height;e.children.forEach((n)=>{J(n,r,t)})}var P=(e,r={})=>{let{isHorizontal:t,forceCompact:n}=r;function h(i){if(i.cs===0){o(i);return}h(i.c[0]);let c=W(N(i.c[0].el),0,null);for(let a=1;a<i.cs;++a){h(i.c[a]);let d=N(i.c[a].er);f(i,a,c,n),c=W(d,a,c)}C(i),o(i)}function o(i){if(i.cs===0)i.el=i,i.er=i,i.msel=i.mser=0;else i.el=i.c[0].el,i.msel=i.c[0].msel,i.er=i.c[i.cs-1].er,i.mser=i.c[i.cs-1].mser}function f(i,c,a,d){let p=i.c[c-1],b=p.mod,y=i.c[c],H=y.mod;while(p!==null&&y!==null){if(N(p)>a.low)a=a.nxt;let _=b+p.prelim+p.w-(H+y.prelim);if(d||_>0)H+=_,s(i,c,a.index,_);let G=N(p),z=N(y);if(G<=z){if(p=m(p),p!==null)b+=p.mod}if(G>=z){if(y=l(y),y!==null)H+=y.mod}}if(!p&&!!y)x(i,c,y,H);else if(!!p&&!y)R(i,c,p,b)}function s(i,c,a,d){i.c[c].mod+=d,i.c[c].msel+=d,i.c[c].mser+=d,le(i,c,a,d)}function l(i){return i.cs===0?i.tl:i.c[0]}function m(i){return i.cs===0?i.tr:i.c[i.cs-1]}function N(i){return i.y+i.h}function x(i,c,a,d){let p=i.c[0].el;p.tl=a;let b=d-a.mod-i.c[0].msel;p.mod+=b,p.prelim-=b,i.c[0].el=i.c[c].el,i.c[0].msel=i.c[c].msel}function R(i,c,a,d){let p=i.c[c].er;p.tr=a;let b=d-a.mod-i.c[c].mser;p.mod+=b,p.prelim-=b,i.c[c].er=i.c[c-1].er,i.c[c].mser=i.c[c-1].mser}function C(i){i.prelim=(i.c[0].prelim+i.c[0].mod+i.c[i.cs-1].mod+i.c[i.cs-1].prelim+i.c[i.cs-1].w)/2-i.w/2}function O(i,c){c+=i.mod,i.x=i.prelim+c,oe(i);for(let a=0;a<i.cs;a++)O(i.c[a],c)}function le(i,c,a,d){if(a!==c-1){let p=c-a;i.c[a+1].shift+=d/p,i.c[c].shift-=d/p,i.c[c].change-=d-d/p}}function oe(i){let c=0,a=0;for(let d=0;d<i.cs;d++)c+=i.c[d].shift,a+=c+i.c[d].change,i.c[d].mod+=a}function W(i,c,a){while(a!==null&&i>=a.low)a=a.nxt;return{low:i,index:c,nxt:a}}J(e,t);let A=D.fromNode(e,t);return h(A),O(A,0),q(A,e,t),me(e,t),e};function ue(e=0,r=[]){let t=this;t.x=t.y=0,t.leftChild=t.rightChild=null,t.height=0,t.children=r}var ye={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function K(e,r,t){if(t)r.x=e.x,r.y=e.y;else r.x=e.y,r.y=e.x;e.children.forEach((n,h)=>{K(n,r.children[h],t)})}var U=(e,r={})=>{r=u({},ye,r);let t=0;function n(l){if(!l)return null;if(l.width=0,l.depth&&l.depth>t)t=l.depth;let m=l.children,N=m.length,x=new ue(l.height,[]);return m.forEach((R,C)=>{let O=n(R);if(x.children.push(O),C===0)x.leftChild=O;if(C===N-1)x.rightChild=O}),x.originNode=l,x.isLeaf=l.isLeaf(),x}function h(l){if(l.isLeaf||l.children.length===0)l.drawingDepth=t;else{let m=l.children.map((x)=>h(x)),N=Math.min.apply(null,m);l.drawingDepth=N-1}return l.drawingDepth}let o=null;function f(l){if(l.x=l.drawingDepth*r.rankSep,l.isLeaf){if(l.y=0,o){if(l.y=o.y+o.height+r.nodeSep,l.originNode.parent!==o.originNode.parent)l.y+=r.subTreeSep}o=l}else l.children.forEach((m)=>{f(m)}),l.y=(l.leftChild.y+l.rightChild.y)/2}let s=n(e);return h(s),f(s),K(s,e,r.isHorizontal),e};var ge=(e,r,t,n,h,o)=>{let f=typeof t==="function"?t(e):t*e.depth;if(!n)try{if(e.id===e.parent.children[0].id||e.id===o?.children?.[0]?.id){e.x+=f,e.y=r?r.y:0;return}}catch(s){}if(e.x+=f,r){if(e.y=r.y+V(r,e,h),r.parent&&e.parent.id!==r.parent.id){let s=r.parent,l=s.y+V(s,e,h);e.y=l>e.y?l:e.y}}else e.y=0;return},E=(e,r,t,n)=>{let h=null;e.eachNode((o)=>{ge(o,h,r,t,n,e),h=o})};function Q(e,r){let t=0;if(!e.children.length)t=e.height;else e.children.forEach((n)=>{t+=Q(n,r)});return e._subTreeSep=r.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,t)+2*e._subTreeSep,e.totalHeight}function X(e){let r=e.children,t=r.length;if(t){r.forEach((s)=>{X(s)});let n=r[0],h=r[t-1],o=h.y-n.y+h.height,f=0;if(r.forEach((s)=>{f+=s.totalHeight}),o>e.height)e.y=n.y+o/2-e.height/2;else if(r.length!==1||e.height>f){let s=e.y+(e.height-o)/2-n.y;r.forEach((l)=>{l.translate(0,s)})}else e.y=(n.y+n.height/2+h.y+h.height/2)/2-e.height/2}}var xe={getSubTreeSep(){return 0}},k=(e,r={})=>{r=u({},xe,r),e.parent={x:0,y:0,width:0,height:0},e.BFTraverse((t)=>{t.x=t.parent.x+t.parent.width}),e.parent=null,Q(e,r),e.startY=0,e.y=e.totalHeight/2-e.height/2,e.eachNode((t)=>{let n=t.children,h=n.length;if(h){let o=n[0];if(o.startY=t.startY+t._subTreeSep,h===1)o.y=t.y+t.height/2-o.height/2;else{o.y=o.startY+o.totalHeight/2-o.height/2;for(let f=1;f<h;f++){let s=n[f];s.startY=n[f-1].startY+n[f-1].totalHeight,s.y=s.startY+s.totalHeight/2-s.height/2}}}}),X(e)};class j extends g{execute(){return w(this.rootNode,this.options,P)}}var v=(e,r)=>{return new j(e,u({},{},r)).execute()};class ee extends g{execute(){return w(this.rootNode,this.options,U)}}var te=(e,r)=>{return new ee(e,u({},{},r)).execute()};var L=["LR","RL","H"],Ne=L[0];class re extends g{execute(){let e=this,r=e.options,t=e.rootNode;r.isHorizontal=!0;let{indent:n=20,dropCap:h=!0,direction:o=Ne,align:f}=r;if(o&&L.indexOf(o)===-1)throw new TypeError(`Invalid direction: ${o}`);if(o===L[0])E(t,n,h,f);else if(o===L[1])E(t,n,h,f),t.right2left();else if(o===L[2]){let{left:s,right:l}=B(t,r);E(s,n,h,f),s.right2left(),E(l,n,h,f);let m=s.getBoundingBox();l.translate(m.width,0),t.x=l.x-t.width/2}return t}}var ie=(e,r)=>{return new re(e,u({},{},r)).execute()};class ne extends g{execute(){return w(this.rootNode,this.options,k)}}var he=(e,r)=>{return new ne(e,u({},{},r)).execute()};export{he as layoutByMindmap,ie as layoutByIndented,te as layoutByDendrogram,v as layoutByCompactBox};
